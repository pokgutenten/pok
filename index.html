<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>병음 퀴즈</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f8ff;
            text-align: center;
            padding: 50px;
        }
        #quiz-container {
            border: 2px solid #333;
            border-radius: 10px;
            background-color: #fff;
            padding: 30px;
            width: 450px;
            margin: auto;
            position: relative;
        }
        #progress {
            margin-bottom: 15px;
            font-size: 18px;
        }
        #cat {
            position: absolute;
            bottom: -50px;
            right: -50px;
            width: 150px;
            animation: float 3s infinite;
        }
        button {
            margin: 10px;
            padding: 12px;
            font-size: 16px;
        }
        input {
            padding: 10px;
            width: 85%;
            margin-top: 10px;
            font-size: 16px;
        }
        @keyframes float {
            0% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
            100% { transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div id="quiz-container">
        <h1>병음 퀴즈</h1>
        <p id="progress">1/50</p>
        <p id="question">뜻: 재난</p>
        <input type="text" id="answer" placeholder="병음을 숫자와 함께 입력하세요 (예: shun4)">
        <br>
        <button onclick="checkAnswer()">제출할거냥?</button>
        <p id="result"></p>
        <img id="cat" src="https://i.postimg.cc/kRVFqj90/cat.gif" alt="까만 고양이">
        <button id="restart-btn" style="display:none;" onclick="restartQuiz()">한번 더?</button>
    </div>

    <script>
        const words = [
            { meaning: "재난", pinyin: "zāinàn", numeric: "zai1nan4" },
            { meaning: "생존", pinyin: "shēngcún", numeric: "sheng1cun2" },
            { meaning: "기술", pinyin: "jìqiǎo", numeric: "ji4qiao3" },
            { meaning: "지진", pinyin: "dìzhèn", numeric: "di4zhen4" },
            { meaning: "전혀 없음", pinyin: "háo wú", numeric: "hao2 wu2" },
            { meaning: "위기", pinyin: "wēijī", numeric: "wei1ji1" },
            { meaning: "대단히", pinyin: "wànfēn", numeric: "wan4fen1" },
            { meaning: "긴급하다", pinyin: "jǐnjí", numeric: "jin3ji2" },
            { meaning: "갖추다", pinyin: "jùbèi", numeric: "ju4bei4" },
            { meaning: "상처", pinyin: "shāng", numeric: "shang1" },
            { meaning: "결과", pinyin: "hòuguǒ", numeric: "hou4guo3" },
            { meaning: "~하기 어렵다", pinyin: "nányǐ", numeric: "nan2yi3" },
            { meaning: "가정하다", pinyin: "jiǎshè", numeric: "jia3she4" },
            { meaning: "제공하다", pinyin: "tígōng", numeric: "ti2gong1" },
            { meaning: "탈출하다", pinyin: "táoshēng", numeric: "tao2sheng1" },
            { meaning: "이, 이것", pinyin: "cǐ", numeric: "ci3" },
            { meaning: "격렬하다", pinyin: "jùliè", numeric: "ju4lie4" },
            { meaning: "흔들리다", pinyin: "yáohuàng", numeric: "yao2huang4" },
            { meaning: "튼튼하다", pinyin: "jiéshi", numeric: "jie2shi" }, // 성조 없는 음절은 숫자 없이 표기
            { meaning: "장롱", pinyin: "guìzi", numeric: "gui4zi" }, // 숫자 제거
            { meaning: "~하지 않도록", pinyin: "yǐmiǎn", numeric: "yi3mian3" },
            { meaning: "부수다", pinyin: "zá", numeric: "za2" },
            { meaning: "무게를 견디다", pinyin: "chéngzhòng", numeric: "cheng2zhong4" },
            { meaning: "~하기보다는", pinyin: "yǔqí", numeric: "yu3qi2" },
            { meaning: "차라리", pinyin: "nìngkě", numeric: "ning4ke3" },
            { meaning: "만약 ~가 아니라면", pinyin: "chúfēi", numeric: "chu2fei1" },
            { meaning: "폐허", pinyin: "fèixū", numeric: "fei4xu1" },
            { meaning: "냉정하다", pinyin: "lěngjìng", numeric: "leng3jing4" },
            { meaning: "발신하다", pinyin: "fāchū", numeric: "fa1chu1" },
            { meaning: "신호", pinyin: "xìnhào", numeric: "xin4hao4" },
            { meaning: "연기", pinyin: "yānwù", numeric: "yan1wu4" },
            { meaning: "불이 붙다", pinyin: "zháohuǒ", numeric: "zhao2huo3" },
            { meaning: "하다, 만들다", pinyin: "nòng", numeric: "nong4" },
            { meaning: "접다", pinyin: "dié", numeric: "die2" },
            { meaning: "해롭다", pinyin: "yǒuhài", numeric: "you3hai4" },
            { meaning: "기체", pinyin: "qìtǐ", numeric: "qi4ti3" },
            { meaning: "일으키다", pinyin: "dǎozhì", numeric: "dao3zhi4" },
            { meaning: "화재", pinyin: "huǒzāi", numeric: "huo3zai1" },
            { meaning: "자세", pinyin: "zīshì", numeric: "zi1shi4" },
            { meaning: "분명하다", pinyin: "qīng", numeric: "qing1" },
            { meaning: "장소", pinyin: "chǎngdì", numeric: "chang3di4" },
            { meaning: "전원", pinyin: "diànyuán", numeric: "dian4yuan2" },
            { meaning: "던지다", pinyin: "tóu", numeric: "tou2" },
            { meaning: "수영하다", pinyin: "yóu", numeric: "you2" },
            { meaning: "언덕", pinyin: "shānpō", numeric: "shan1po1" },
            { meaning: "전이하다", pinyin: "zhuǎnyí", numeric: "zhuan3yi2" },
            { meaning: "같은 방향으로", pinyin: "shùn", numeric: "shun4" },
            { meaning: "피하다", pinyin: "bì", numeric: "bi4" },
            { meaning: "~에 이르지 않다", pinyin: "búzhìyú", numeric: "bu2zhi4yu2" },
            { meaning: "멈추지 않다", pinyin: "bùzhǐ", numeric: "bu4zhi3" }
        ];

        // 숫자 병음을 성조 표기로 변환하는 함수
        function convertToPinyinWithTone(input) {
            const toneMap = {
                '1': ['ā', 'ē', 'ī', 'ō', 'ū', 'ǖ'],
                '2': ['á', 'é', 'í', 'ó', 'ú', 'ǘ'],
                '3': ['ǎ', 'ě', 'ǐ', 'ǒ', 'ǔ', 'ǚ'],
                '4': ['à', 'è', 'ì', 'ò', 'ù', 'ǜ']
            };
            const vowels = ['a', 'e', 'i', 'o', 'u', 'v']; // 'v' is for ü (u with umlaut)

let result = input;
for (let tone in toneMap) {
    for (let i = 0; i < vowels.length; i++) {
        let vowel = vowels[i];
        let regex = new RegExp(vowel + tone, 'g');
        result = result.replace(regex, toneMap[tone][i]);
    }
}
return result;
}

// 성조가 없는 병음 처리를 위해서는 numeric 속성에서 숫자를 빼고 비교
function checkAnswer() {
const answer = document.getElementById("answer").value.trim();
const numericAnswer = words[currentQuestionIndex].numeric.replace(/5/g, ''); // 경성 숫자 제거
const pinyinAnswer = words[currentQuestionIndex].pinyin;
const convertedAnswer = convertToPinyinWithTone(answer.replace(/\s/g, '')); // 공백 제거 후 변환
const resultElement = document.getElementById("result");

if (answer.replace(/\s/g, '') === numericAnswer || convertedAnswer === pinyinAnswer) {
    resultElement.innerText = `정답이다냥! (${pinyinAnswer})`;
    score++;
} else {
    resultElement.innerText = `아니다냥! 정답은 ${pinyinAnswer} 이다냥.`;
}

if (usedIndices.length < totalQuestions) {
    setTimeout(showQuestion, 2000);  // 2초 후 다음 문제로 이동
} else {
    resultElement.innerText += " 끝났다냥!";
    document.getElementById("restart-btn").style.display = "inline";
}
}

// 진행 상황 업데이트
function updateProgress() {
const progressElement = document.getElementById("progress");
progressElement.innerText = `${usedIndices.length}/${totalQuestions}`;
}

// 퀴즈 다시 시작
function restartQuiz() {
usedIndices = [];
score = 0;
document.getElementById("restart-btn").style.display = "none";
showQuestion();
}

// 랜덤으로 새로운 질문 표시
function getRandomIndex() {
let index;
do {
    index = Math.floor(Math.random() * words.length);
} while (usedIndices.includes(index));
usedIndices.push(index);
return index;
}

// 첫 질문 표시
function showQuestion() {
currentQuestionIndex = getRandomIndex();
const questionElement = document.getElementById("question");
questionElement.innerText = `뜻: ${words[currentQuestionIndex].meaning}`;
document.getElementById("answer").value = '';
document.getElementById("result").innerText = '';
updateProgress();
}

// Enter 키로 제출하는 이벤트 추가
document.getElementById("answer").addEventListener("keydown", function(event) {
if (event.key === "Enter") {
    checkAnswer();
}
});

window.onload = showQuestion;
</script>
</body>
</html>
